---
layout: post
title:  "Linux多线程"
category: Linux
date:   2015-09-02
---
> 本文章根据手头资料跟网络资料整理，非原创。将就看吧
> 
> 编写环境 Mac电脑，也有可能是Ubuntu 麒麟

###线程概念

#### 什么是线程

* 在一个程序里的一个执行线路叫做线程（thread）。更准确的定义是：线程是“一个进程内部的控制序列”
* 一切进程至少有一个执行线程

#### 进程与线程

进程是资源分配的最小单位，线程是CPU调度的最小单位

* 进程是资源竞争的基本单位
* 线程是程序执行的最小单位
* 线程共享进程数据，但也拥有自己的一部分数据
	* 线程ID
	* 程序计数器
	* 寄存器组
	* 栈
	* errno
* 一个进程内部的线程可以共享资源
	* 代码段
	* 数据段
	* 打开文件和信号
	
#####fork 和创建新线程的区别

* 当一个进程执行一个`fork`调用时候，会创建出进程的一个新拷贝，新进程将拥有它自己的变量和它自己的`PID`。这个新进程的运行时间是独立的，它在执行时几乎完全独立于创建它的进程
* 在进程里面创建一个新线程的时候，新的执行线程会拥有自己的堆栈（因此也就有自己的局部变量），但要与它的创建者共享全局变量、文件描述符、信号处理和当前的工作目录状态

##### 线程的优点

* 创建一个新线程的代价要比创建一个新进程小的多
* 与进程之间的切换相比，线程之间的切换需要操作系统做的工作要少很多
* 线程占用资源要不进程少很多
* 能充分利用多处理器的可并行数量
* 在等待慢速`I/O`操作结束的同时，程序可执行其他的计算任务
* 计算密集型应用，为了能在多处理器系统上运行，将计算分解到多个线程中实现
* `I/O`密集型应用，为了提高性能，将`I/O`操作重叠。线程可以同时等待不同的`I/O`操作

##### 线程缺点

* 性能损失
	* 一个很少被外部事件阻塞的计算密集型线程往往无法与其他线程共享一个处理器。如果计算密集型线程的数量比可用的处理器多，那么可能会有较大的性能损失，这里的性能损失指的是增加额外的同步和调度开销，而可用的资源不变
	* 




#### 线程模型

	



参考资料：

* 《Linux多线程实践(1) --线程理论》 <http://www.bubuko.com/infodetail-548574.html>
* 《多线程还是多进程的选择及区别》<http://blog.csdn.net/lishenglong666/article/details/8557215>

 















